(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{213:function(t,e,a){"use strict";a.r(e);var n=a(28),s=Object(n.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"用户端（前端-客户端）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用户端（前端-客户端）"}},[t._v("#")]),t._v(" 用户端（前端/客户端）")]),t._v(" "),a("h2",{attrs:{id:"demo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#demo"}},[t._v("#")]),t._v(" Demo")]),t._v(" "),a("p",[t._v("测试后端地址："),a("a",{attrs:{href:"https://backend.skimproj.com/public/notice-column",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://backend.skimproj.com"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("测试示例："),a("a",{attrs:{href:"https://backend.skimproj.com/public/notice-column",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://backend.skimproj.com/public/notice-column"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"通用返回结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通用返回结果"}},[t._v("#")]),t._v(" 通用返回结果")]),t._v(" "),a("p",[t._v("大部分POST返回结果默认为：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('{\n    "Result":1/2/3,\n    //1：成功\n    //2：失败\n    //3：异常\n    "Message":"500",    //待定\n    "Jwt":"..."\n    //有时jwt证书临近过期，此时任意POST会触发更新jwt，返回结果会附上新的jwt\n    //因为jwt中保存了language信息，如果用户切换language，POST结果也会收到jwt\n}\n')])])]),a("p",[t._v("GET/POST返回的"),a("code",[t._v("Result")]),t._v("还有可能是"),a("code",[t._v("logout")]),t._v("，表示需要重新登录。")]),t._v(" "),a("p",[t._v("例如，用户修改密码导致旧的jwt被拉黑。")]),t._v(" "),a("h2",{attrs:{id:"列表查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#列表查询"}},[t._v("#")]),t._v(" 列表查询")]),t._v(" "),a("blockquote",[a("p",[t._v("后端提供了大量的列表查询API，格式统一：")])]),t._v(" "),a("h3",{attrs:{id:"get-xxx-columns"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-xxx-columns"}},[t._v("#")]),t._v(" GET /xxx-columns")]),t._v(" "),a("blockquote",[a("p",[t._v("查询【列表的所有column（列名）】")])]),t._v(" "),a("p",[t._v("请求参数：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("language=zh-Hans（/public下需要此参数，/user下不需要）\n")])])]),a("p",[t._v("返回：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('{\n    "Result":1,\n    "Total":122,    //数据总数\n    "Columns":[\n        {\n            "Name":"menu",    //列名\n            "Text":"菜单"    //用于显示至前端，根据language的不同而显示不同的文字\n            "Reference":"false"/"true",    //后续部分会解释\n            \n            "Filters":[    //适用于该列的筛选\n                {\n                    "Value":"admin",\n                    "Text":"管理员"\n                },\n                {\n                    "Value":"affman",\n                    "Text":"affman"\n                }\n            ]\n        }\n    ]\n}\n')])])]),a("h3",{attrs:{id:"get-xxx-list"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-xxx-list"}},[t._v("#")]),t._v(" GET /xxx-list")]),t._v(" "),a("blockquote",[a("p",[t._v("对列表进行分页查询")])]),t._v(" "),a("p",[t._v("请求参数：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("筛选：（不写时，视为查找所有type）\nfilter[scenario]=1*2&&filter[type]=1\n//scenario列筛选1和2，type列筛选1\n\n语言：（/public下需要此参数，/user下不需要）\nlanguage=1\n\n时区：（/public下需要此参数，/user下不需要）\ntimezone=480\n//北京时区+8，则为8*60=480\n\n按哪列排序：（不写时，使用默认排序）\nsort=password&asc=true\n//按password升续排列\n\n每页容量：\nnumber=10\n\n页码：\npage=1\n\n查找：\nsearch=hello\n\n是否查询完整内容：\nfull=true（false时仅返回hash id数组，true时返回完整内容）\n")])])]),a("p",[t._v("返回：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('full=false时返回：{\n    "Result":1,\n    "Total":122,    //数据总数\n    "Items":[3a28ja,sadr22,3af34,4r33]    //hash id数组\n}\n\nfull=true时返回：{\n    "Result":1,\n    "Total":122,    //数据总数\n    "Items":[    //根据column返回一个list内容的二维数组\n        [\n            ...\n        ]\n    ]\n}\n')])])]),a("h3",{attrs:{id:"get-xxx-pick"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-xxx-pick"}},[t._v("#")]),t._v(" GET /xxx-pick")]),t._v(" "),a("blockquote",[a("p",[t._v("查询指定hash id")])]),t._v(" "),a("p",[t._v("请求参数：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("hash-id=...（可以同时查询多个id）\n\n时区：（/public下需要此参数，/user下不需要）\ntimezone=480\n//北京时区+8，则为8*60=480\n\n")])])]),a("p",[t._v("返回结果：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("结构与分页查询/xxx-list的full=true返回结构相同\n")])])]),a("h3",{attrs:{id:"reference用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reference用法"}},[t._v("#")]),t._v(" reference用法")]),t._v(" "),a("p",[t._v("/xxx-columns中提及到，column有一个reference属性，值为false/true")]),t._v(" "),a("p",[t._v("值为false时，说明list返回的就是很直白的数据")]),t._v(" "),a("p",[t._v("比如/node-list返回以下数据：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('"Items":[\n    {\n        "Name":"中国A",    //节点名，reference:false\n        "Online":2    //在线人数，reference:false\n    }\n]\n')])])]),a("p",[t._v("对应生成的列表就是：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("节点名")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("在线人数")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("中国A")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("2")])])])]),t._v(" "),a("p",[t._v("当值为true时，说明这个column涉及另一张表")]),t._v(" "),a("p",[t._v("比如/order-columns返回以下数据：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('"Total":123,    //数据总数\n"Columns":[\n    {\n        "Name":"time"\n        "Text":"订单时间",\n        "Reference":"false"    //这里为false，则什么都不用管\n    },\n    {\n        "Name":"menu"\n        "Text":"菜单",\n        "Reference":"true"    //这里为true，说明一定存在/menu列表查询和精确查询\n    }    \n]\n')])])]),a("p",[t._v("reference为true的column，返回的内容是一个hash id")]),t._v(" "),a("p",[t._v("接着上面的例子，/order-list返回以下数据：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('"Items":[\n    [\n        "2019-01-01 01:00:00",    //name，reference:false\n        "54f7gh",    //menu，reference:true，这里返回的是一个menu的id\n                     //id不是数字，而是字符串（hash id）\n    ],\n    [\n        "2019-01-02 02:00:00",\n        "74ngx",\n    ]\n]\n')])])]),a("p",[t._v("reference的显示方法相当自由，可以显示一串字符串：")]),t._v(" "),a("p",[t._v("（因为reference为true，所以一定存在/menu列表查询和精确查询）")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("订单时间")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("菜单")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("2019-01-01 01:00:00")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("租金：1元 限速：10M 流量价格：1元/G")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("2019-01-02 02:00:00")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("租金：2元 限速：20M 流量价格：2元/G")])])])]),t._v(" "),a("p",[t._v("一个超链接：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("订单时间")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("菜单")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("2019-01-01 01:00:00")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("[菜单1](http://aaa.com/user/menu/1)")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("2019-01-02 02:00:00")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("[菜单2](http://aaa.com/user/menu/2)")])])])]),t._v(" "),a("p",[t._v("或者直接什么都不做，直接把hash id放上去：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("订单时间")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("菜单")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("2019-01-01 01:00:00")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("54f7gh")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("2019-01-02 02:00:00")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("74ngx")])])])]),t._v(" "),a("h3",{attrs:{id:"get-xxx-edit"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-xxx-edit"}},[t._v("#")]),t._v(" GET /xxx-edit")]),t._v(" "),a("blockquote",[a("p",[t._v("获取xxx的[编辑/新建]页面")])]),t._v(" "),a("p",[t._v("请求参数：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("hash-id=6hf76tgk（如果为0，则为新建）\n")])])]),a("h3",{attrs:{id:"post-xxx-remove"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#post-xxx-remove"}},[t._v("#")]),t._v(" POST /xxx-remove")]),t._v(" "),a("blockquote",[a("p",[t._v("删除列表中的一项或多项")])]),t._v(" "),a("p",[t._v("请求参数：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('{\n    "Items":["i776jk","k67g3"]    //仅hash id\n}\n')])])]),a("h2",{attrs:{id:"jwt内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jwt内容"}},[t._v("#")]),t._v(" JWT内容")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('Claims:{\n    "Expiry":"2019-07-15T03:59:30Z"    //遵循RFC3339且总是UTC时区\n    "HashId":"a382jw"    //用户的hash id\n    "Language":2    //用户的语言\n}\n')])])]),a("h2",{attrs:{id:"动态编辑框"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#动态编辑框"}},[t._v("#")]),t._v(" 动态编辑框")]),t._v(" "),a("p",[t._v("动态编辑框用于[列表查询的xxx-edit/config修改]等场合，根据后端返回内容动态生成")]),t._v(" "),a("p",[t._v("编辑框有以下`"),a("code",[t._v("type")]),t._v("，并且拥有"),a("code",[t._v("check")]),t._v("检查条件：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("type 种类")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("check 检查条件")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("integer 整数")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("范围区间检查，如：[1,4)U{6,7}，这是一个区间和集合的并集")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("decimal 小数")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("范围区间检查，如：(3.8,6]")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("string （单行）字符串")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("正则表达式检查")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("text （多行）文本")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("正则表达式检查")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("array 下拉菜单")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("可选内容数组，如：admin=管理员&banned=被封禁用户")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("bool 开关")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("值只能为true或false")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("date 日期")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("范围区间检查，如：[2019/03/21,2020/01/01)")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("time 时间")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("范围区间检查，如：[2019/03/21 12:12:12,2020/01/01 12:12:12)")])])])]),t._v(" "),a("p",[a("code",[t._v("type")]),t._v("用于告知前端选择合适的编辑框，如：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("array种类通常用下拉菜单显示\nbool种类则用开关控件显示\ninteger、decimal既可以使用普通文字编辑框控件，也可以使用数字控件\ndate既可以使用普通文字编辑控件，也可以使用日历控件\n")])])]),a("p",[a("code",[t._v("check")]),t._v("用于对编辑框输入值的检查，并不强制要求全部实现，甚至最简单粗暴的做法就是：全部使用普通文字编辑框，然后把"),a("code",[t._v("检查")]),t._v("以文字注释的方式标在旁边")]),t._v(" "),a("p",[t._v("使用场景：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('通过GET /user/admin/user-edit?hashId=23y66b\n可能收到返回：{\n    "Edits":[\n        {\n            "Name":"email",\n            "Text":"邮箱",\n            "Type":"string",    //显示普通的文字编辑框\n            "Check":"[^@]+@[^\\.]+\\..+",    //一个简易的email检查\n            "Value":"xxx@yy.com"    //这个文字编辑框的当前值\n        },\n        {\n            "Name":"role",\n            "Text":"角色",\n            "Type":"array",\n            "Check":"admin=管理员&banned=被封禁用户&common=普通用户",\n            //前端显示一个下拉菜单，文字分别是“管理员”、“被封禁用户”、“普通用户”\n            "Value":"common",    //这个用户是一个普通用户，所以默认选择common\n        },\n        ...    //其他编辑项\n    ]\n}\n\n通过POST /user/admin/user-update\n对值进行更新：{\n    "HashId":"23y66b",\n    "Updates":[\n        {\n            "name":"role",\n            "value":"admin"\n        }\n    ]\n}\n')])])]),a("p",[t._v("/admin/config-edit也使用此类返回")])])}),[],!1,null,null,null);e.default=s.exports}}]);